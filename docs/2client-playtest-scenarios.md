# 2-Client Playtest Scenarios

목적:

- 실전 2클라 환경에서 `재접속`, `중간합류`, `동시 건설` 동기화 품질을 검증한다.

사전 준비:

1. 서버/클라 실행: `npm run dev:all`
2. 클라이언트 A: 일반 브라우저 창
3. 클라이언트 B: 시크릿 창(또는 다른 브라우저)
4. 둘 다 같은 URL 접속(기본 `http://localhost:5173`)
5. 둘 다 ONLINE 탭에서 GLOBAL 로비 진입

공통 체크:

1. A는 `ALPHA`, B는 `BRAVO` 선택
2. 팀 미선택 상태에서는 시작 불가 메시지가 보여야 함
3. 양팀 최소 1명씩일 때만 시작 가능해야 함

## Scenario 1: 재접속 (Reconnect)

절차:

1. A/B 모두 팀 선택 후 매치 시작
2. A가 블록 5개 설치, B가 블록 3개 제거
3. A가 적 깃발을 픽업한 상태를 만든다
4. A 브라우저 탭을 닫아서 강제 이탈
5. B는 10초 동안 블록 5개 추가 설치
6. A가 다시 접속해서 같은 방으로 자동 재진입

기대 결과:

1. A 재접속 직후 `room:snapshot` 기준으로 월드가 B와 동일해야 함
2. A가 끊긴 동안 변경된 블록이 A에도 모두 보여야 함
3. A가 들고 있던 깃발은 서버에서 리셋되어 홈 위치로 복귀해야 함
4. A/B 점수와 캡처 수치가 동일해야 함

실패 기준:

1. A/B 월드에 블록 개수나 위치가 다름
2. 깃발이 공중 고정/사라짐 상태로 남음
3. 재접속 후 사격/피격 판정이 한쪽에서만 동작

## Scenario 2: 중간합류 (Join-In-Progress)

절차:

1. A만 먼저 접속해서 블록 20개를 설치하고 전투 진행
2. B는 30초 뒤 접속해서 로비 진입
3. B 팀 선택 후 매치 시작 이벤트 수신
4. B 시점에서 기존 월드 상태 확인
5. B가 A 위치를 확인하고 서로 교전

기대 결과:

1. B 최초 진입 시 기존 블록 변경 내역이 누락 없이 보임
2. A/B의 플레이어 위치 동기화가 1초 내 안정화됨
3. 팀이 다르면 즉시 상호 피격 가능해야 함
4. B의 HUD Objective가 팀 기준 CTF 목표로 표시되어야 함

실패 기준:

1. B에서 초기 월드가 기본 지형만 보임
2. A는 보는데 B는 못 보는 블록이 지속적으로 남음
3. 중간합류 직후 PvP가 불가하거나 한쪽만 데미지 적용

## Scenario 3: 동시 건설 (Concurrent Build)

절차:

1. A/B를 같은 좌표 근처로 이동
2. 20초 동안 같은 구역에 동시에 설치/제거 반복
3. A가 서 있는 좌표에 B가 설치 시도
4. A는 해당 위치에서 2초 뒤 옆으로 이동
5. 이동 후 3초 내 양쪽 월드 상태 비교

기대 결과:

1. 동일 좌표 충돌 시 최종 상태가 양쪽에서 동일해야 함
2. 플레이어 몸과 겹친 원격 설치는 큐 처리 후 이동 시 반영되어야 함
3. 설치/제거 스팸 후에도 블록 렌더 팝(사라짐/깜빡임)이 지속되지 않아야 함

실패 기준:

1. 한쪽만 보이는 고스트 블록이 5초 이상 지속
2. 플레이어 이동 후에도 대기 중 설치 블록이 영구 누락
3. 카메라 각도에 따라 블록이 반복적으로 사라졌다 나타남

## 기록 템플릿

1. 테스트 일시:
2. 브랜치/커밋:
3. 시나리오:
4. 결과: PASS / FAIL
5. 실패 시 재현 스텝:
6. 콘솔/서버 로그 요약:

